<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='UTF-8'>
<title>Bunny Match Game</title>
<style>
  body { font-family: sans-serif; text-align: center; margin-top: 2rem; }
  #bunny { width: 150px; cursor: grab; }
  #drop-target {
    width: 230px;
    height: 230px;
    margin: 2rem auto;
    background-size: contain;
    background-repeat: no-repeat;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .heart {
    position: absolute;
    font-size: 24px;
    color: hotpink;
    animation: float 1s forwards;
    left: 50%%;
    top: 50%%;
  }
  @keyframes float {
    from { transform: translate(-50%%, -50%%) scale(1); opacity: 1; }
    to   { transform: translate(-50%%, -200%%) scale(2); opacity: 0; }
  }
</style>
</head>
<body>
<h1>Drag the bunny into the silhouette</h1>
<div>
  <button id="prev">Prev</button>
  <button id="next">Next</button>
</div>
<img id='bunny' draggable='true'>
<div id='drop-target'></div>
<script>
// Define the available bunny/silhouette pairs. Each object points to its image assets.
const pairs = [
  { id: '001', bunny: 'assets/pairs/001/bunny.png', silhouette: 'assets/pairs/001/silhouette.png' },
  { id: '002', bunny: 'assets/pairs/002/bunny.png', silhouette: 'assets/pairs/002/silhouette.png' }
];

// Track which pair is currently displayed
let currentIndex = 0;

// Render the current pair onto the page
function showPair() {
  const pair = pairs[currentIndex];
  const bunnyImg = document.getElementById('bunny');
  bunnyImg.src = pair.bunny;
  const dropTargetDiv = document.getElementById('drop-target');
  dropTargetDiv.style.backgroundImage = `url(${pair.silhouette})`;
  dropTargetDiv.innerHTML = '';
}

// Switch to the next pair
document.getElementById('next').addEventListener('click', () => {
  currentIndex = (currentIndex + 1) % pairs.length;
  showPair();
});

// Switch to the previous pair
document.getElementById('prev').addEventListener('click', () => {
  currentIndex = (currentIndex - 1 + pairs.length) % pairs.length;
  showPair();
});

// Setup drag handling for the bunny
const bunnyElem = document.getElementById('bunny');
bunnyElem.addEventListener('dragstart', (e) => {
  e.dataTransfer.setData('text/plain', 'bunny');
});

// Handle drop events on the silhouette
const dropTargetDiv = document.getElementById('drop-target');
dropTargetDiv.addEventListener('dragover', (e) => e.preventDefault());
dropTargetDiv.addEventListener('drop', (e) => {
  e.preventDefault();
  const data = e.dataTransfer.getData('text/plain');
  if (data === 'bunny') {
    // Clear any existing elements and place a copy of the bunny inside
    dropTargetDiv.innerHTML = '';
    dropTargetDiv.appendChild(bunnyElem.cloneNode(true));
    // Emit hearts as a visual reward
    for (let i = 0; i < 5; i++) {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.textContent = '❤️';
      heart.style.left = (50 + (Math.random() - 0.5) * 60) + '%';
      heart.style.animationDuration = (1 + Math.random()) + 's';
      dropTargetDiv.appendChild(heart);
      setTimeout(() => heart.remove(), 1500);
    }
  }
});

// Initialize with the first pair when the page loads
showPair();
</script>
</body>
</html>
